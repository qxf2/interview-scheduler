# This file is used to create the Github actions for deploying into the server


name: Interview-Scheduler

on :
  push
    branches:
    -master


jobs:
  build:
      runs-on: ubuntu-latest

  steps:
      -name: Executing remote ssh commands using Github actions
      uses: qxf2/interview-scheduler@master
      with:
        host: ${{ secrets.HOST }}
        username: ${{ secrets.USERNAME }}
        key: ${{ secrets.PROD_KEY }}
        port: ${{ secrets.port }}
        script: |
            git pull origin master
            mv maintenance_off.html maintenance_on.html
            pip install -r requirements.txt
            python migrate_db.py db migrate
            python migrate_db.py db upgrade
            sudo service gunicorn restart
            mv maintenance_on.html maintenance_off.html

